var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
var KEY_UP=1,KEY_RIGHT=2,KEY_DOWN=3,KEY_LEFT=4,KEY_JUMP=5,KEY_ESC=6,keyboard=Array(8);function is_key_pressed(a){return keyboard[a]}function release_key(a){keyboard[a]=0}function set_key_pressed(a,b){37==a?keyboard[KEY_LEFT]=b:38==a?keyboard[KEY_UP]=b:39==a?keyboard[KEY_RIGHT]=b:40==a?keyboard[KEY_DOWN]=b:32==a||13==a?keyboard[KEY_JUMP]=b:27==a&&(keyboard[KEY_ESC]=b)}
var PALETTE_CPC=[0,0,0,0,0,128,0,0,255,128,0,0,128,0,128,128,0,255,255,0,0,255,0,128,255,0,255,0,128,0,0,128,128,0,128,255,128,128,0,128,128,128,128,128,255,255,128,0,255,128,128,255,128,255,0,255,0,0,255,128,0,255,255,128,255,0,128,255,128,128,255,255,255,255,0,255,255,128,255,255,255],palette32=new Uint32Array(4);function set_palette_color(a,b){b*=3;palette32[a]=-16777216|PALETTE_CPC[b+2]<<16|PALETTE_CPC[b+1]<<8|PALETTE_CPC[b]}var SCREEN_W=320,SCREEN_H=200,screen8=new Uint8Array(SCREEN_W*SCREEN_H);
function clear_screen(){screen8.fill(0)}function draw_object(a,b,c){var d=get_object_width(a),e=get_object_height(a);a=get_object_addr(a);for(var f=0;f<e;++f)for(var h=(c+f)*SCREEN_W+4*b,k=0;k<d;++k){var g=snapshot[a++];screen8[h++]^=(g>>3&1)<<1|g>>7&1;screen8[h++]^=(g>>2&1)<<1|g>>6&1;screen8[h++]^=(g>>1&1)<<1|g>>5&1;screen8[h++]^=(g&1)<<1|g>>4&1}}function draw_object2(a,b,c){draw_object(a,b,c)}var SNAPSHOT_SIZE=40960,snapshot=Array(SNAPSHOT_SIZE);
function get_object_width(a){return snapshot[6902+a]}function get_object_height(a){return snapshot[7158+a]}function get_object_addr(a){return snapshot[6390+a]<<8|snapshot[6646+a]}var thread_num,threads_bytecode=Array(256),bytecode_offset,vars1=Array(60),vars2=Array(60);function clear_vars(){vars1.fill(0);vars2.fill(0)}function get_bytecode_addr(a){return snapshot[7414+a]<<8|snapshot[7670+a]}function clear_threads(){threads_bytecode.fill(0)}
function set_thread_bytecode(a,b){threads_bytecode[b]=get_bytecode_addr(a)}
var opcodes={62:function(){draw_object(player_frame,vars1[0],vars2[0])},63:function(){vars1[0]&=-2},64:function(){var a=snapshot[bytecode_offset++],b=snapshot[bytecode_offset++];set_thread_bytecode(a,b)},65:function(){1!=player_disabled&&0==var_num&&0==(snapshot[7926+get_next_tile()]&1)?bytecode_offset+=1:vars1[var_num]+=snapshot[bytecode_offset++]},66:function(){1!=player_disabled&&0==var_num&&0==(snapshot[7926+get_next_tile()]&2)?bytecode_offset+=1:vars1[var_num]-=snapshot[bytecode_offset++]},67:function(){1!=
player_disabled&&0==var_num&&0==(snapshot[7926+get_next_tile()]&4)?bytecode_offset+=1:vars2[var_num]+=snapshot[bytecode_offset++]},68:function(){1!=player_disabled&&1!=player_jumping&&0==var_num&&0==(snapshot[7926+get_next_tile()]&8)?bytecode_offset+=1:vars2[var_num]-=snapshot[bytecode_offset++]},69:function(){vars1[var_num]=snapshot[bytecode_offset++]},70:function(){vars2[var_num]=snapshot[bytecode_offset++]},71:function(){tilemap_x_pos=snapshot[bytecode_offset++];tilemap_y_pos=snapshot[bytecode_offset++];
var a=snapshot[bytecode_offset++];tilemap[get_tile_offset()]=a},72:function(){tilemap_x_pos=snapshot[bytecode_offset++];tilemap_y_pos=snapshot[bytecode_offset++];for(var a=snapshot[bytecode_offset++],b=snapshot[bytecode_offset++],c=0;c<a;++c)tilemap[get_tile_offset()]=b,tilemap_y_pos+=1},73:function(){tilemap_x_pos=snapshot[bytecode_offset++];tilemap_y_pos=snapshot[bytecode_offset++];for(var a=snapshot[bytecode_offset++],b=snapshot[bytecode_offset++],c=0;c<a;++c)tilemap[get_tile_offset()]=b,tilemap_x_pos+=
1},74:function(){var a=snapshot[bytecode_offset++];set_thread_bytecode(a,thread_num);bytecode_offset=threads_bytecode[thread_num]},75:function(){var a=vars1[var_num],b=vars2[var_num],c=snapshot[bytecode_offset++];draw_object(c,a,b)},76:function(){var_num=snapshot[bytecode_offset++]},77:function(){threads_bytecode[thread_num]=bytecode_offset},79:function(){keys_flag=0;player_jumping=threads_bytecode[0]=0},80:function(){player_disabled=1;threads_bytecode[0]=0},81:function(){player_frame=snapshot[bytecode_offset++]},
82:function(){var a=snapshot[bytecode_offset++],b=get_object_width(a),c=get_object_height(a),d=vars1[var_num],e=vars2[var_num],f=vars1[0];if(!(f<d||f+1<d)){if(f!=d&&f+1!=d&&(d+=b,f!=d&&f>d&&(f+=1,f!=d&&f>d)))return;b=vars2[0]+7;if(!(b<e||b+5<e)){if(b!=e&&b+5!=e&&(e+=c,b>=e&&(b+=5,b!=e&&b>e)))return;set_thread_bytecode(snapshot[8438+a],a)}}},83:function(){var a=snapshot[bytecode_offset++];set_thread_bytecode(a,0)},84:function(){for(var a=snapshot[bytecode_offset++],b=snapshot[bytecode_offset++],c=
snapshot[bytecode_offset++],d=snapshot[bytecode_offset++],e=0;e<c;++e)draw_object(d,a,b),a+=get_object_width(d)},85:function(){for(var a=snapshot[bytecode_offset++],b=snapshot[bytecode_offset++],c=snapshot[bytecode_offset++],d=snapshot[bytecode_offset++],e=0;e<c;++e)draw_object(d,a,b),b+=get_object_height(d)},86:function(){increase_score(1)},87:function(){var a=snapshot[bytecode_offset++];if(0!=snapshot[8694+a]&&(--snapshot[8694+a],0!=snapshot[8694+a])){a=snapshot[bytecode_offset++];set_thread_bytecode(a,
thread_num);bytecode_offset=threads_bytecode[thread_num];return}bytecode_offset+=1},88:function(){var a=snapshot[bytecode_offset++],b=snapshot[bytecode_offset++];snapshot[8694+a]=b},89:function(){var a=vars1[var_num],b=vars2[var_num],c=snapshot[bytecode_offset++];draw_object2(c,a,b)}};
function run_threads(){for(thread_num=0;256>thread_num;++thread_num)for(bytecode_offset=threads_bytecode[thread_num];0!=bytecode_offset;){opcode=snapshot[bytecode_offset];if(78==opcode){break_flag=1;return}if(90==opcode)break;bytecode_offset+=1;opcodes[opcode]();if(77==opcode||79==opcode)break}}var keys,score,highscore=0,boxes,hunger,lifes,infinite_lifes=!1,player_disabled,var_num,keys_flag,player_jumping,ticks,screen_num,break_flag,start_pos,counter3,player_direction,player_frame;
function initialize(){snapshot[10445]=2;snapshot[10446]=2;snapshot[10447]=2;snapshot[10448]=2;snapshot[10449]=2;snapshot[10450]=2;snapshot[10451]=2;snapshot[10452]=2;snapshot[10453]=2;snapshot[10454]=2;snapshot[10455]=2;snapshot[10405]=1;snapshot[10408]=1;snapshot[10409]=1;snapshot[10412]=1;snapshot[10414]=1;snapshot[10325]=1;snapshot[10326]=1;snapshot[10329]=1;snapshot[10362]=1;snapshot[10364]=1;boxes=score=keys=0;hunger=99;lifes=6;screen_num=4;ticks=20;set_palette_color(2,21);set_palette_color(3,
14);start_pos=0}function restart(){if(!infinite_lifes&&(--lifes,0==lifes)){state=STATE_TITLE;return}console.log("restart start_pos:"+start_pos+" screen_num:"+screen_num);if(0!=start_pos){if(6==start_pos)return;screen_num=snapshot[10525+start_pos];start_pos+=1;counter3=100}vars1[0]=snapshot[10487+screen_num];vars2[0]=snapshot[10501+screen_num];player_frame=1;change_screen()}function run_game_threads(){clear_threads();set_thread_bytecode(100+screen_num,1);run_threads()}
function set_threads_screen(){clear_threads();var a=0;0!=screen_num&&(a+=128*screen_num);for(var b=1;128>b;++b)set_thread_bytecode(snapshot[8734+a+b],b)}function set_thread_boxes(){10==boxes&&3==screen_num&&set_thread_bytecode(126,0)}
function change_screen(){clear_screen();clear_tilemap();draw_panel_score();draw_panel_highscore();draw_panel_hunger();draw_panel_lifes();threads_bytecode[0]=0;run_game_threads();draw_object_food();draw_object_reward();draw_object_key();draw_object_box();set_threads_screen();draw_object(player_frame,vars1[0],vars2[0]);break_flag=player_disabled=keys_flag=player_jumping=0;set_thread_boxes()}
function update_game_state(){if(1==player_disabled)return run_threads(),1==break_flag?!1:!0;tile_flags=snapshot[7926+get_next_tile()];0!=(tile_flags&240)&&(draw_object(player_frame,vars1[0],vars2[0]),tile_flags&16&&(vars1[0]+=1),tile_flags&32&&--vars1[0],tile_flags&64&&(vars2[0]+=1),tile_flags&128&&--vars2[0],draw_object(player_frame,vars1[0],vars2[0]));var a=get_next_tile();0!=snapshot[8438+a]&&set_thread_bytecode(snapshot[8438+a],a);1!=keys_flag&&(a=get_next_tile(),0!=snapshot[8182+a]?(set_thread_bytecode(snapshot[8182+
a],0),keys_flag=1):0==start_pos&&(is_key_pressed(KEY_JUMP)?(0!=player_direction?set_thread_bytecode(6,0):set_thread_bytecode(5,0),player_jumping=keys_flag=1):(a=get_next_tile(),0!=(snapshot[7926+a]&12)&&(is_key_pressed(KEY_UP)?(set_thread_bytecode(3,0),keys_flag=1):is_key_pressed(KEY_DOWN)&&(set_thread_bytecode(4,0),keys_flag=1)),is_key_pressed(KEY_RIGHT)?(set_thread_bytecode(1,0),keys_flag=1,player_direction=0):is_key_pressed(KEY_LEFT)&&(set_thread_bytecode(2,0),player_direction=keys_flag=1))));
handle_food();handle_reward();handle_key();handle_box();run_threads();if(10==boxes&&3==screen_num&&2==vars1[0]&&130==vars2[0])state=STATE_COMPLETED;else{if(0!=start_pos){a=start_pos;start_pos=0;if(is_key_pressed(KEY_JUMP))return!1;start_pos=a;--counter3;if(0==counter3)return!1}0==vars2[0]||1==vars2[0]?(vars2[0]=150,screen_num+=3,change_screen()):151<vars2[0]?(vars2[0]=2,screen_num-=3,change_screen()):0==vars1[0]?(vars1[0]=77,--screen_num,change_screen()):79<vars1[0]&&(vars1[0]=2,screen_num+=1,change_screen())}return!0}
function draw_object_food(){var a=10319+screen_num;if(0!=snapshot[a]){var b=snapshot[a+14];a=snapshot[a+28];draw_object(58,b,a);tilemap_x_pos=b>>1;tilemap_y_pos=a+7>>3;tilemap[get_tile_offset()]=50}}function handle_food(){if(50==get_next_tile()){tilemap[tilemap_offset]=1;var a=10361+screen_num;snapshot[a]=0;draw_object(58,snapshot[a+14],snapshot[a+28]);increase_score(1);draw_panel_hunger();hunger=99;draw_panel_hunger()}}
function draw_object_reward(){var a=10361+screen_num;if(0!=snapshot[a]){var b=snapshot[a+14];a=snapshot[a+28];draw_object(21,b,a);tilemap_x_pos=b>>1;tilemap_y_pos=a+4>>3;tilemap[get_tile_offset()]=51}}function handle_reward(){if(51==get_next_tile()){tilemap[tilemap_offset]=1;var a=10361+screen_num;snapshot[a]=0;draw_object(21,snapshot[a+14],snapshot[a+28]);increase_score(2);draw_panel_hunger();hunger=99;draw_panel_hunger()}}
function draw_object_key(){var a=10403+screen_num;if(0!=snapshot[a]){var b=snapshot[a+14];a=snapshot[a+28];draw_object(37,b,a);tilemap_x_pos=b>>1;tilemap_y_pos=a+5>>3;tilemap[get_tile_offset()]=52}}function handle_key(){if(52==get_next_tile()){tilemap[tilemap_offset]=1;var a=10403+screen_num;snapshot[a]=0;draw_object(37,snapshot[a+14],snapshot[a+28]);keys+=2;increase_score(5)}}
function draw_object_box(){var a=10445+screen_num;if(0!=snapshot[a]){var b=snapshot[a+14];a=snapshot[a+28]+4;draw_object(38,b,a);tilemap_x_pos=b>>1;tilemap_y_pos=a+4>>3;tilemap[get_tile_offset()]=53}}function handle_box(){if(53==get_next_tile()){tilemap[tilemap_offset]=1;var a=10445+screen_num;snapshot[a]=0;var b=snapshot[a+14];a=snapshot[a+28]+4;draw_object(38,b,a);draw_object(39,b,a);increase_score(4);boxes+=1;--keys;set_thread_boxes()}}
function increase_score(a){draw_panel_highscore();draw_panel_score();score+=67*a;score>highscore&&(highscore=score);draw_panel_highscore();draw_panel_score()}var tilemap=Array(840),tilemap_x_pos,tilemap_y_pos,tilemap_offset;function clear_tilemap(){tilemap.fill(0)}function get_tile_offset(){tilemap_offset=tilemap_x_pos;0!=tilemap_y_pos&&(tilemap_offset+=40*tilemap_y_pos);return tilemap_offset}
function get_current_tile(){tilemap_x_pos=vars1[0]>>1;tilemap_y_pos=vars2[0]+8>>3;return tilemap[get_tile_offset()]}function get_next_tile(){var a=get_current_tile();0==a&&(vars1[0]+=1,a=get_current_tile(),--vars1[0]);return a}function draw_panel_number(a,b,c,d){c+=2*b;for(var e=0;e<b;++e)c-=2,draw_object(44+a%10,c,d),a=a/10>>0}function draw_panel_score(){draw_panel_number(score,6,36,176)}function draw_panel_highscore(){draw_panel_number(highscore,6,64,176)}
function draw_panel_hunger(){draw_panel_number(hunger,2,40,184)}function draw_panel_lifes(){draw_panel_number(lifes,2,68,184)}var canvas,timer,audio,INTERVAL=100;function init(a){canvas=document.getElementById(a);document.onkeydown=function(a){set_key_pressed(a.keyCode,1)};document.onkeyup=function(a){set_key_pressed(a.keyCode,0)};audio=new Audio("inferrun.ogg");audio.addEventListener("ended",function(){this.currentTime=0;this.play()},!1)}
function pause(){if(timer)return audio.pause(),clearInterval(timer),timer=null,!0;audio.play();timer=setInterval(tick,INTERVAL);return!1}function reset(){clear_vars();set_palette_color(0,0);set_palette_color(1,6);state=STATE_TITLE;timer&&clearInterval(timer);timer=setInterval(tick,INTERVAL)}function mute(){if(!audio.paused)return audio.pause(),!0;audio.play();return!1}function set_infinite_lifes(a){infinite_lifes=a}
function update_screen(){for(var a=canvas.getContext("2d"),b=a.getImageData(0,0,SCREEN_W,SCREEN_H),c=new Uint32Array(b.data.buffer),d=0;d<SCREEN_W*SCREEN_H;++d)c[d]=palette32[screen8[d]];a.putImageData(b,0,0)}function load_snapshot(a){for(var b=0;b<SNAPSHOT_SIZE;++b)snapshot[b]=a.charCodeAt(b)&255;reset()}var STATE_TITLE=1,STATE_GAME=2,STATE_COMPLETED=3,state,prev_state;
function tick(){state!=prev_state&&(state==STATE_TITLE?(clear_screen(),set_palette_color(2,2),set_palette_color(3,26),clear_threads(),set_thread_bytecode(130,10)):state==STATE_GAME?(initialize(),restart()):state==STATE_COMPLETED&&(clear_screen(),clear_tilemap(),clear_threads(),set_thread_bytecode(132,10),player_direction=200),prev_state=state);state==STATE_TITLE?(run_threads(),is_key_pressed(KEY_JUMP)&&(release_key(KEY_JUMP),state=STATE_GAME)):state==STATE_GAME?update_game_state()?(--ticks,0==ticks&&
(ticks=18,draw_panel_hunger(),--hunger,draw_panel_hunger(),0==hunger&&restart())):restart():state==STATE_COMPLETED&&(run_threads(),--player_direction,0==player_direction&&(state=STATE_TITLE));update_screen()};
